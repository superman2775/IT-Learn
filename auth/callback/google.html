<!DOCTYPE html>
<html>
<head><title>Verifying...</title></head>
<body>
  <div>
    <h2>Verifying Google Login...</h2>
    <p>Please wait while we log you in.</p>
  </div>
  <script src="https://unpkg.com/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
  <script>
    const SUPABASE_URL = 'https://YOUR-REAL-PROJECT.supabase.co';
    const SUPABASE_ANON_KEY = 'YOUR-REAL-ANON-KEY';
    
    const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY, {
      auth: { flowType: 'pkce', detectSessionInUrl: true }
    });

    supabase.auth.getSession().then(({ data, error }) => {
      if (error || !data.session) {
        window.location.href = '/login.html';
        return;
      }
      
      // Send token to backend (your existing endpoint)
      fetch('https://itlearn.pythonanywhere.com/api/session-from-supabase', {
        method: 'POST',
        credentials: 'include',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ access_token: data.session.access_token })
      }).then(() => {
        window.location.href = '/learn/learn.html';
      });
    });
  </script>
</body>
</html>
